/*!
 * jQuery Tools v1.2.6 - The missing UI library for the Web
 * 
 * overlay/overlay.js
 * overlay/overlay.apple.js
 * toolbox/toolbox.expose.js
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 */
(function(f){f.tools=f.tools||{version:"v1.2.6"},f.tools.overlay={addEffect:function(i,c,j){h[i]=[c,j]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!f.browser.msie||f.browser.version>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var e=[],h={};f.tools.overlay.addEffect("default",function(a,k){var j=this.getConf(),i=f(window);j.fixed||(a.top+=i.scrollTop(),a.left+=i.scrollLeft()),a.position=j.fixed?"fixed":"absolute",this.getOverlay().css(a).fadeIn(j.speed,k)},function(b){this.getOverlay().fadeOut(this.getConf().closeSpeed,b)});function g(v,u){var t=this,s=v.add(t),r=f(window),q,p,o,c=f.tools.expose&&(u.mask||u.expose),b=Math.random().toString().slice(10);c&&(typeof c=="string"&&(c={color:c}),c.closeOnClick=c.closeOnEsc=!1);var a=u.target||v.attr("rel");p=a?f(a):null||v;if(!p.length){throw"Could not find Overlay: "+a}v&&v.index(p)==-1&&v.click(function(d){t.load(d);return d.preventDefault()}),f.extend(t,{load:function(w){if(t.isOpened()){return t}var j=h[u.effect];if(!j){throw'Overlay: cannot find effect : "'+u.effect+'"'}u.oneInstance&&f.each(e,function(){this.close(w)}),w=w||f.Event(),w.type="onBeforeLoad",s.trigger(w);if(w.isDefaultPrevented()){return t}o=!0,c&&f(p).expose(c);var x=u.top,m=u.left,l=p.outerWidth({margin:!0}),k=p.outerHeight({margin:!0});typeof x=="string"&&(x=x=="center"?Math.max((r.height()-k)/2,0):parseInt(x,10)/100*r.height()),m=="center"&&(m=Math.max((r.width()-l)/2,0)),j[0].call(t,{top:x,left:m},function(){o&&(w.type="onLoad",s.trigger(w))}),c&&u.closeOnClick&&f.mask.getMask().one("click",t.close),u.closeOnClick&&f(document).bind("click."+b,function(d){f(d.target).parents(p).length||t.close(d)}),u.closeOnEsc&&f(document).bind("keydown."+b,function(d){d.keyCode==27&&t.close(d)});return t},close:function(d){if(!t.isOpened()){return t}d=d||f.Event(),d.type="onBeforeClose",s.trigger(d);if(!d.isDefaultPrevented()){o=!1,h[u.effect][1].call(t,function(){d.type="onClose",s.trigger(d)}),f(document).unbind("click."+b).unbind("keydown."+b),c&&f.mask.close();return t}},getOverlay:function(){return p},getTrigger:function(){return v},getClosers:function(){return q},isOpened:function(){return o},getConf:function(){return u}}),f.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(d,i){f.isFunction(u[i])&&f(t).bind(i,u[i]),t[i]=function(j){j&&f(t).bind(i,j);return t}}),q=p.find(u.close||".close"),!q.length&&!u.close&&(q=f('<a class="close"></a>'),p.prepend(q)),q.click(function(d){t.close(d)}),u.load&&t.load()}f.fn.overlay=function(b){var a=this.data("overlay");if(a){return a}f.isFunction(b)&&(b={onBeforeLoad:b}),b=f.extend(!0,{},f.tools.overlay.conf,b),this.each(function(){a=new g(f(this),b),e.push(a),f(this).data("overlay",a)});return b.api?a:this}})(jQuery);(function(h){var g=h.tools.overlay,l=h(window);h.extend(g.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});function k(d){var c=d.offset();return{top:c.top+d.height()/2,left:c.left+d.width()/2}}var j=function(z,y){var x=this.getOverlay(),w=this.getConf(),v=this.getTrigger(),u=this,t=x.outerWidth({margin:!0}),s=x.data("img"),r=w.fixed?"fixed":"absolute";if(!s){var q=x.css("backgroundImage");if(!q){throw"background-image CSS property not set for overlay"}q=q.slice(q.indexOf("(")+1,q.indexOf(")")).replace(/\"/g,""),x.css("backgroundImage","none"),s=h('<img src="'+q+'"/>'),s.css({border:0,display:"none"}).width(t),h("body").append(s),x.data("img",s)}var d=w.start.top||Math.round(l.height()/2),c=w.start.left||Math.round(l.width()/2);if(v){var a=k(v);d=a.top,c=a.left}w.fixed?(d-=l.scrollTop(),c-=l.scrollLeft()):(z.top+=l.scrollTop(),z.left+=l.scrollLeft()),s.css({position:"absolute",top:d,left:c,width:0,zIndex:w.zIndex}).show(),z.position=r,x.css(z),s.animate({top:x.css("top"),left:x.css("left"),width:t},w.speed,function(){x.css("zIndex",w.zIndex+1).fadeIn(w.fadeInSpeed,function(){u.isOpened()&&!h(this).index(x)?y.call():x.hide()})}).css("position",r)},i=function(a){var o=this.getOverlay().hide(),n=this.getConf(),m=this.getTrigger(),d=o.data("img"),c={top:n.start.top,left:n.start.left,width:0};m&&h.extend(c,k(m)),n.fixed&&d.css({position:"absolute"}).animate({top:"+="+l.scrollTop(),left:"+="+l.scrollLeft()},0),d.animate(c,n.closeSpeed,a)};g.addEffect("apple",j,i)})(jQuery);(function(r){r.tools=r.tools||{version:"v1.2.6"};var q;q=r.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};function p(){if(r.browser.msie){var a=r(document).height(),d=r(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a-d<20?d:a]}return[r(document).width(),r(document).height()]}function o(a){if(a){return a.call(r.mask)}}var n,m,l,k,j;r.mask={load:function(c,b){if(l){return this}typeof c=="string"&&(c={color:c}),c=c||k,k=c=r.extend(r.extend({},q.conf),c),n=r("#"+c.maskId),n.length||(n=r("<div/>").attr("id",c.maskId),r("body").append(n));var a=p();n.css({position:"absolute",top:0,left:0,width:a[0],height:a[1],display:"none",opacity:c.startOpacity,zIndex:c.zIndex}),c.color&&n.css("backgroundColor",c.color);if(o(c.onBeforeLoad)===!1){return this}c.closeOnEsc&&r(document).bind("keydown.mask",function(d){d.keyCode==27&&r.mask.close(d)}),c.closeOnClick&&n.bind("click.mask",function(d){r.mask.close(d)}),r(window).bind("resize.mask",function(){r.mask.fit()}),b&&b.length&&(j=b.eq(0).css("zIndex"),r.each(b,function(){var d=r(this);/relative|absolute|fixed/i.test(d.css("position"))||d.css("position","relative")}),m=b.css({zIndex:Math.max(c.zIndex+1,j=="auto"?0:j)})),n.css({display:"block"}).fadeTo(c.loadSpeed,c.opacity,function(){r.mask.fit(),o(c.onLoad),l="full"}),l=!0;return this},close:function(){if(l){if(o(k.onBeforeClose)===!1){return this}n.fadeOut(k.closeSpeed,function(){o(k.onClose),m&&m.css({zIndex:j}),l=!1}),r(document).unbind("keydown.mask"),n.unbind("click.mask"),r(window).unbind("resize.mask")}return this},fit:function(){if(l){var b=p();n.css({width:b[0],height:b[1]})}},getMask:function(){return n},isLoaded:function(b){return b?l=="full":l},getConf:function(){return k},getExposed:function(){return m}},r.fn.mask=function(a){r.mask.load(a);return this},r.fn.expose=function(a){r.mask.load(a,this);return this}})(jQuery);(function(d){var f={put:function(h,g){(g||window).location.hash=this.encoder(h)},get:function(i){var h=((i||window).location.hash).replace(/^#/,"");try{return d.browser.mozilla?h:decodeURIComponent(h)}catch(g){return h}},encoder:encodeURIComponent};var c={id:"__jQuery_history",init:function(){var g='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';d("body").prepend(g);return this},_document:function(){return d("#"+this.id)[0].contentWindow.document},put:function(h){var g=this._document();g.open();g.close();f.put(h,g)},get:function(){return f.get(this._document())}};function e(h){h=d.extend({unescape:false},h||{});f.encoder=i(h.unescape);function i(j){if(j===true){return function(k){return k}}if(typeof j=="string"&&(j=g(j.split("")))||typeof j=="function"){return function(k){return j(encodeURIComponent(k))}}return encodeURIComponent}function g(k){var j=new RegExp(d.map(k,encodeURIComponent).join("|"),"ig");return function(l){return l.replace(j,decodeURIComponent)}}}var b={};b.base={callback:undefined,type:undefined,check:function(){},load:function(g){},init:function(h,g){e(g);a.callback=h;a._options=g;a._init()},_init:function(){},_options:{}};b.timer={_appState:undefined,_init:function(){var g=f.get();a._appState=g;a.callback(g);setInterval(a.check,100)},check:function(){var g=f.get();if(g!=a._appState){a._appState=g;a.callback(g)}},load:function(g){if(g!=a._appState){f.put(g);a._appState=g;a.callback(g)}}};b.iframeTimer={_appState:undefined,_init:function(){var g=f.get();a._appState=g;c.init().put(g);a.callback(g);setInterval(a.check,100)},check:function(){var h=c.get(),g=f.get();if(g!=h){if(g==a._appState){a._appState=h;f.put(h);a.callback(h)}else{a._appState=g;c.put(g);a.callback(g)}}},load:function(g){if(g!=a._appState){f.put(g);c.put(g);a._appState=g;a.callback(g)}}};b.hashchangeEvent={_init:function(){a.callback(f.get());d(window).bind("hashchange",a.check)},check:function(){a.callback(f.get())},load:function(g){f.put(g)}};var a=d.extend({},b.base);if(d.browser.msie&&(d.browser.version<8||document.documentMode<8)){a.type="iframeTimer"}else{if("onhashchange" in window){a.type="hashchangeEvent"}else{a.type="timer"}}d.extend(a,b[a.type]);d.history=a})(jQuery);(function(i,h,n){var m=h.event,l;m.special.smartresize={setup:function(){h(this).bind("resize",m.special.smartresize.handler)},teardown:function(){h(this).unbind("resize",m.special.smartresize.handler)},handler:function(f,e){var o=this,g=arguments;f.type="smartresize",l&&clearTimeout(l),l=setTimeout(function(){jQuery.event.handle.apply(o,g)},e==="execAsap"?0:100)}},h.fn.smartresize=function(b){return b?this.bind("smartresize",b):this.trigger("smartresize",["execAsap"])},h.Mason=function(b,d){this.element=h(d),this._create(b),this._init()};var k=["position","height"];h.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1},h.Mason.prototype={_filterFindBricks:function(d){var c=this.options.itemSelector;return c?d.filter(c).add(d.find(c)):d},_getBricks:function(d){var c=this._filterFindBricks(d).css({position:"absolute"}).addClass("masonry-brick");return c},_create:function(r){this.options=h.extend(!0,{},h.Mason.settings,r),this.styleQueue=[],this.reloadItems();var q=this.element[0].style;this.originalStyle={};for(var p=0,o=k.length;p<o;p++){var f=k[p];this.originalStyle[f]=q[f]||""}this.element.css({position:"relative"}),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={};var b=h(document.createElement("div"));this.element.prepend(b),this.offset.y=Math.round(b.position().top),this.options.isRTL?(b.css({"float":"right",display:"inline-block"}),this.offset.x=Math.round(this.element.outerWidth()-b.position().left)):this.offset.x=Math.round(b.position().left),b.remove();var a=this;setTimeout(function(){a.element.addClass("masonry")},0),this.options.isResizable&&h(i).bind("smartresize.masonry",function(){a.resize()})},_init:function(b){this._getColumns(),this._reLayout(b)},option:function(b,d){h.isPlainObject(b)&&(this.options=h.extend(!0,this.options,b))},layout:function(D,C){var B,A,z,y,x,w;for(var v=0,u=D.length;v<u;v++){B=h(D[v]),A=Math.ceil(B.outerWidth(!0)/this.columnWidth),A=Math.min(A,this.cols);if(A===1){this._placeBrick(B,this.colYs)}else{z=this.cols+1-A,y=[];for(w=0;w<z;w++){x=this.colYs.slice(w,w+A),y[w]=Math.max.apply(Math,x)}this._placeBrick(B,y)}}var t={};t.height=Math.max.apply(Math,this.colYs)-this.offset.y;if(this.options.isFitWidth){var s=0,v=this.cols;while(--v){if(this.colYs[v]!==this.offset.y){break}s++}t.width=(this.cols-s)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:t});var r=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",q=this.options.animationOptions,b;for(v=0,u=this.styleQueue.length;v<u;v++){b=this.styleQueue[v],b.$el[r](b.style,q)}this.styleQueue=[],C&&C.call(D),this.isLaidOut=!0},_getColumns:function(){var d=this.options.isFitWidth?this.element.parent():this.element,c=d.width();this.columnWidth=this.options.columnWidth||this.$bricks.outerWidth(!0)||c,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((c+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(w,v){var u=Math.min.apply(Math,v),t=0;for(var s=0,r=v.length;s<r;s++){if(v[s]===u){t=s;break}}var q={top:u};q[this.horizontalDirection]=this.columnWidth*t+this.offset.x,this.styleQueue.push({$el:w,style:q});var p=u+w.outerHeight(!0),o=this.cols+1-r;for(s=0;s<o;s++){this.colYs[t+s]=p}},resize:function(){var b=this.cols;this._getColumns(),this.cols!==b&&this._reLayout()},_reLayout:function(d){var c=this.cols;this.colYs=[];while(c--){this.colYs.push(this.offset.y)}this.layout(this.$bricks,d)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(b){this.reloadItems(),this._init(b)},appended:function(f,e,o){if(e){this._filterFindBricks(f).css({top:this.element.height()});var g=this;setTimeout(function(){g._appended(f,o)},1)}else{this._appended(f,o)}},_appended:function(e,d){var f=this._getBricks(e);this.$bricks=this.$bricks.add(f),this.layout(f,d)},remove:function(b){this.$bricks=this.$bricks.not(b),b.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var o=this.element[0].style;for(var f=0,b=k.length;f<b;f++){var a=k[f];o[a]=this.originalStyle[a]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),h(i).unbind(".masonry")}},h.fn.imagesLoaded=function(o){function p(){--s<=0&&this.src!==r&&(setTimeout(q),t.unbind("load error",p))}function q(){o.call(c,t)}var c=this,t=c.find("img").add(c.filter("img")),s=t.length,r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";s||q(),t.bind("load error",p).each(function(){if(this.complete||this.complete===n){var b=this.src;this.src=r,this.src=b}});return c};var j=function(b){this.console&&console.error(b)};h.fn.masonry=function(b){if(typeof b=="string"){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var a=h.data(this,"masonry");if(!a){j("cannot call methods on masonry prior to initialization; attempted to call method '"+b+"'")}else{if(!h.isFunction(a[b])||b.charAt(0)==="_"){j("no such method '"+b+"' for masonry instance");return}a[b].apply(a,d)}})}else{this.each(function(){var a=h.data(this,"masonry");a?(a.option(b||{}),a._init()):h.data(this,"masonry",new h.Mason(b,this))})}return this}})(window,jQuery);
/*!
 * jQuery imagesLoaded plugin v1.0.4
 * http://github.com/desandro/imagesloaded
 *
 * MIT License. by Paul Irish et al.
 */
(function(a,b){a.fn.imagesLoaded=function(i){var g=this,e=g.find("img").add(g.filter("img")),c=e.length,h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";function f(){i.call(g,e)}function d(j){if(--c<=0&&j.target.src!==h){setTimeout(f);e.unbind("load error",d)}}if(!c){f()}e.bind("load error",d).each(function(){if(this.complete||this.complete===b){var j=this.src;this.src=h;this.src=j}});return g}})(jQuery);(function(n,i,k){i.infinitescroll=function y(B,D,C){this.element=i(C);this._create(B,D)};i.infinitescroll.defaults={loading:{finished:k,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:k},state:{isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,currPage:1},callback:k,debug:false,behavior:k,binder:i(n),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:false,pathParse:k,dataType:"html",appendCallback:true,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:k,path:k};i.infinitescroll.prototype={_binding:function g(D){var B=this,C=B.options;if(!!C.behavior&&this["_binding_"+C.behavior]!==k){this["_binding_"+C.behavior].call(this);return}if(D!=="bind"&&D!=="unbind"){this._debug("Binding value  "+D+" not valid");return false}if(D=="unbind"){(this.options.binder).unbind("smartscroll.infscr."+B.options.infid)}else{(this.options.binder)[D]("smartscroll.infscr."+B.options.infid,function(){B.scroll()})}this._debug("Binding",D)},_create:function s(B,F){if(!this._validate(B)){return false}var C=this.options=i.extend(true,{},i.infinitescroll.defaults,B),E=/(.*?\/\/).*?(\/.*)/,D=i(C.nextSelector).attr("href");C.contentSelector=C.contentSelector||this.element;C.loading.selector=C.loading.selector||C.contentSelector;if(!D){this._debug("Navigation selector not found");return}C.path=this._determinepath(D);C.loading.msg=i('<div id="infscr-loading"><img alt="Loading..." src="'+C.loading.img+'" /><div>'+C.loading.msgText+"</div></div>");(new Image()).src=C.loading.img;C.pixelsFromNavToBottom=i(document).height()-i(C.navSelector).offset().top;C.loading.start=C.loading.start||function(){i(C.navSelector).hide();C.loading.msg.appendTo(C.loading.selector).show(C.loading.speed,function(){beginAjax(C)})};C.loading.finished=C.loading.finished||function(){C.loading.msg.fadeOut("normal")};C.callback=function(G,H){if(!!C.behavior&&G["_callback_"+C.behavior]!==k){G["_callback_"+C.behavior].call(i(C.contentSelector)[0],H)}if(F){F.call(i(C.contentSelector)[0],H)}};this._setup()},_debug:function p(){if(this.options.debug){return n.console&&console.log.call(console,arguments)}},_determinepath:function z(C){var B=this.options;if(!!B.behavior&&this["_determinepath_"+B.behavior]!==k){this["_determinepath_"+B.behavior].call(this,C);return}if(!!B.pathParse){this._debug("pathParse manual");return B.pathParse}else{if(C.match(/^(.*?)\b2\b(.*?$)/)){C=C.match(/^(.*?)\b2\b(.*?$)/).slice(1)}else{if(C.match(/^(.*?)2(.*?$)/)){if(C.match(/^(.*?page=)2(\/.*|$)/)){C=C.match(/^(.*?page=)2(\/.*|$)/).slice(1);return C}C=C.match(/^(.*?)2(.*?$)/).slice(1)}else{if(C.match(/^(.*?page=)1(\/.*|$)/)){C=C.match(/^(.*?page=)1(\/.*|$)/).slice(1);return C}else{this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");B.state.isInvalidPage=true}}}}this._debug("determinePath",C);return C},_error:function u(C){var B=this.options;if(!!B.behavior&&this["_error_"+B.behavior]!==k){this["_error_"+B.behavior].call(this,C);return}if(C!=="destroy"&&C!=="end"){C="unknown"}this._debug("Error",C);if(C=="end"){this._showdonemsg()}B.state.isDone=true;B.state.currPage=1;B.state.isPaused=false;this._binding("unbind")},_loadcallback:function c(F,G){var E=this.options,I=this.options.callback,B=(E.state.isDone)?"done":(!E.appendCallback)?"no-append":"append",H;if(!!E.behavior&&this["_loadcallback_"+E.behavior]!==k){this["_loadcallback_"+E.behavior].call(this,F,G);return}switch(B){case"done":this._showdonemsg();return false;break;case"no-append":if(E.dataType=="html"){G="<div>"+G+"</div>";G=i(G).find(E.itemSelector)}break;case"append":var D=F.children();if(D.length==0){return this._error("end")}H=document.createDocumentFragment();while(F[0].firstChild){H.appendChild(F[0].firstChild)}this._debug("contentSelector",i(E.contentSelector)[0]);i(E.contentSelector)[0].appendChild(H);G=D.get();break}E.loading.finished.call(i(E.contentSelector)[0],E);if(E.animate){var C=i(n).scrollTop()+i("#infscr-loading").height()+E.extraScrollPx+"px";i("html,body").animate({scrollTop:C},800,function(){E.state.isDuringAjax=false})}if(!E.animate){E.state.isDuringAjax=false}I(this,G)},_nearbottom:function t(){var C=this.options,B=0+i(document).height()-(C.binder.scrollTop())-i(n).height();if(!!C.behavior&&this["_nearbottom_"+C.behavior]!==k){this["_nearbottom_"+C.behavior].call(this);return}this._debug("math:",B,C.pixelsFromNavToBottom);return(B-C.bufferPx<C.pixelsFromNavToBottom)},_pausing:function l(C){var B=this.options;if(!!B.behavior&&this["_pausing_"+B.behavior]!==k){this["_pausing_"+B.behavior].call(this,C);return}if(C!=="pause"&&C!=="resume"&&C!==null){this._debug("Invalid argument. Toggling pause value instead")}C=(C&&(C=="pause"||C=="resume"))?C:"toggle";switch(C){case"pause":B.state.isPaused=true;break;case"resume":B.state.isPaused=false;break;case"toggle":B.state.isPaused=!B.state.isPaused;break}this._debug("Paused",B.state.isPaused);return false},_setup:function q(){var B=this.options;if(!!B.behavior&&this["_setup_"+B.behavior]!==k){this["_setup_"+B.behavior].call(this);return}this._binding("bind");return false},_showdonemsg:function a(){var B=this.options;if(!!B.behavior&&this["_showdonemsg_"+B.behavior]!==k){this["_showdonemsg_"+B.behavior].call(this);return}B.loading.msg.find("img").hide().parent().find("div").html(B.loading.finishedMsg).animate({opacity:1},2000,function(){i(this).parent().fadeOut("normal")});B.errorCallback.call(i(B.contentSelector)[0],"done")},_validate:function v(C){for(var B in C){if(B.indexOf&&B.indexOf("Selector")>-1&&i(C[B]).length===0){this._debug("Your "+B+" found no elements.");return false}return true}},bind:function o(){this._binding("bind")},destroy:function A(){this.options.state.isDestroyed=true;return this._error("destroy")},pause:function e(){this._pausing("pause")},resume:function h(){this._pausing("resume")},retrieve:function b(H){var I=this,C=I.options,K=C.path,E,J,L,B,D,H=H||null,G=(!!H)?H:C.state.currPage;beginAjax=function F(M){M.state.currPage++;I._debug("heading into ajax",K);E=i(M.contentSelector).is("table")?i("<tbody/>"):i("<div/>");L=K.join(M.state.currPage);B=(M.dataType=="html"||M.dataType=="json")?M.dataType:"html+callback";if(M.appendCallback&&M.dataType=="html"){B+="+callback"}switch(B){case"html+callback":I._debug("Using HTML via .load() method");E.load(L+" "+M.itemSelector,null,function N(O){I._loadcallback(E,O)});break;case"html":case"json":I._debug("Using "+(B.toUpperCase())+" via $.ajax() method");i.ajax({url:L,dataType:M.dataType,complete:function N(O,P){D=(typeof(O.isResolved)!=="undefined")?(O.isResolved()):(P==="success"||P==="notmodified");(D)?I._loadcallback(E,O.responseText):I._error("end")}});break}};if(!!C.behavior&&this["retrieve_"+C.behavior]!==k){this["retrieve_"+C.behavior].call(this,H);return}if(C.state.isDestroyed){this._debug("Instance is destroyed");return false}C.state.isDuringAjax=true;C.loading.start.call(i(C.contentSelector)[0],C)},scroll:function f(){var B=this.options,C=B.state;if(!!B.behavior&&this["scroll_"+B.behavior]!==k){this["scroll_"+B.behavior].call(this);return}if(C.isDuringAjax||C.isInvalidPage||C.isDone||C.isDestroyed||C.isPaused){return}if(!this._nearbottom()){return}this.retrieve()},toggle:function x(){this._pausing()},unbind:function m(){this._binding("unbind")},update:function j(B){if(i.isPlainObject(B)){this.options=i.extend(true,this.options,B)}}};i.fn.infinitescroll=function d(D,E){var C=typeof D;switch(C){case"string":var B=Array.prototype.slice.call(arguments,1);this.each(function(){var F=i.data(this,"infinitescroll");if(!F){return false}if(!i.isFunction(F[D])||D.charAt(0)==="_"){return false}F[D].apply(F,B)});break;case"object":this.each(function(){var F=i.data(this,"infinitescroll");if(F){F.update(D)}else{i.data(this,"infinitescroll",new i.infinitescroll(D,E,this))}});break}return this};var w=i.event,r;w.special.smartscroll={setup:function(){i(this).bind("scroll",w.special.smartscroll.handler)},teardown:function(){i(this).unbind("scroll",w.special.smartscroll.handler)},handler:function(E,B){var D=this,C=arguments;E.type="smartscroll";if(r){clearTimeout(r)}r=setTimeout(function(){i.event.handle.apply(D,C)},B==="execAsap"?0:100)}};i.fn.smartscroll=function(B){return B?this.bind("smartscroll",B):this.trigger("smartscroll",["execAsap"])}})(window,jQuery);(function(a){a(document).ready(function(){var f=a(window),d=a("#main");function e(g,h){var i=(h=="width")?f.width():f.height();return parseInt((i/2)-((parseInt(g.data(h))+40)/2),10)}function c(g){var h=/^\/image\/(\d+)\.gif$/g.exec(g.attr("href").trim());if(h!==null){a.history.load(h[1])}return false}function b(g){g.each(function(j,k){var h=a(k);h.imagesLoaded(function(){h.fadeIn("slow")})}).children("a").click(function(){return c(a(this))})}d.masonry({itemSelector:"li",columnWidth:25});b(d.find("li"));d.imagesLoaded(function(g){a("#main").infinitescroll({debug:false,navSelector:".next",nextSelector:".next",itemSelector:"#main li",bufferPx:100,loading:{finishedMsg:"",img:"/static/img/loading.gif",msgText:"",},pathParse:{join:function(h){return"/"+h}}},function(h){var i=a(h);b(i);d.masonry("appended",i,true)});a.history.init(function(k){if(k==""){return}var i=d.find('a[href = "/image/'+k+'.gif"]');if(i.size()<1){return}var h=a(".overlay");if(h.size()>0){var j=h.children("img").hide().attr("src",i.attr("href"));a.merge(j,h).animate({width:i.data("width")+"px",height:i.data("height")+"px",left:e(i,"width"),top:e(i,"height")});j.imagesLoaded(function(){j.fadeIn("fast")});return}i;h=a("<div/>").addClass("overlay").css({position:"absolute",width:i.data("width")+"px",height:i.data("height")+"px"}).appendTo("body").overlay({load:true,left:e(i,"width"),top:e(i,"height"),mask:{color:"#000",opacity:0.4,loadSpeed:200},onBeforeLoad:function(l){i.css("boxShadow","none")},onClose:function(l){h.remove();a.history.load("")}});a("<img/>").attr("src",i.attr("href")).attr("width",i.data("width")).attr("height",i.data("height")).click(function(){i=i.parent().next().children("a");if(i.size()==0){i=$items.filter(":first")}return c(i)}).appendTo(h)},{unescape:",/"})})})})(jQuery);